# @WebService Notes

## 01. BS vs CS Architecture
#### B/S: Browser to Server
- Browser send the request to server
- Server perform the operation
- Server render the result
- Browser receive the response from server
#### C/S: Client(Swing/Awt) to Server
- Client perform the operation
#### RPC: Client(Swing/Awt) to Server
- Server perform the operation
- Client is rich UI
***


## 02. LPC vs RPC
#### LRC
- Local Procedure Call, operation is perfomed by local application
#### RPC
- Remote Procedure Call, part/whole operation is performed by whole application 
	+ CGI			HTTP statless, key-value pair transimission
	+ RMI			Remote Method Invocation, Simple, Less resource
	+ CORBA 		Common Object Request Broker Architecture, Data exchange by binary data in IIOP Protocal
	+ RMI-IIOP 		Remote Method Invocation - Internet Inter-Ojbect Protocal, Combine advantage of RMI and CORBA 
	+ COM+ 			Common Object Model
	+ SOAP			Simple Object Access Protocal


	
3. WebService
- Overview
	Solution for integration of distributed system of cross language/perform
	Different applications/language communication via the [text] and [socket]
- SOAP: Simple Object Access Protocal
			exchange the data base on standard XML document base on Http Protocal 
			exchange the data in distributed system
— ESB:	Enterprise Service Bus
			OA App		CRM App	 		Service: addUser/deleteUser()
			|			 	| 			Service Description:
			|<---> ESB <--->|
			|				|
— SOA:	Service Oriented Architecture, lunching software as the services
- OXM:	Object-Xml mapping for releasing service



4. TCP/IP Monitor
- Local Monitor Port: 8000
- Host & Port: 8080
- Request -> 8000 -> 8080 -> Server



5. Web Service JDK6
- JDK6 support the WebService
- Annotation
	@WebService				Class as WebService
	@WebMethod 				Method as WebService operation
	@WebResult(name="...")	Response name
	@WebPara(name="...")	Request name
- WebService Server
	Endpoint.publish("url", new ServiceObj());
- Communication
	Data: 		Request and Response based on XML
	Protocal:	Reqeuest and Response througth Http protocal
	SOAP: 		Simple Object Access Protocal
				Generate the message base on WSDL
- Request Message
	<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
	<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" >
		<soap:Header>
		</soap:Header>
		<soap:Body>
			<ws.d:welcome xmlns:ws.d="http://ws.dbs.com/">
			<!-- optional -->
			<arg0>tom</arg0>
			</ws.d:welcome>
		</soap:Body>
	</soap:Envelope>
- Response
	<?xml version="1.0" encoding="UTF-8"?>
	<S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
		<S:Header/>
		<S:Body>
			<ns2:welcomeResponse xmlns:ns2="http://ws.dbs.com/">
				<return>Welcome, tom</return>
			</ns2:welcomeResponse>
		</S:Body>
	</S:Envelope>
- WSDL: Web Service Description Language
	<?xml version="1.0" encoding="UTF-8"?><!-- Published by JAX-WS RI at http://jax-ws.dev.java.net. RI's version is JAX-WS RI 2.1.6 in JDK 6. --><!-- Generated by JAX-WS RI at http://jax-ws.dev.java.net. RI's version is JAX-WS RI 2.1.6 in JDK 6. --><definitions xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:tns="http://ws.dbs.com/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://schemas.xmlsoap.org/wsdl/" targetNamespace="http://ws.dbs.com/" name="S01_WelcomeServiceService">
	<types>
		<xsd:schema>
			<xsd:import namespace="http://ws.dbs.com/" schemaLocation="http://localhost:7075/WelcomeServices?xsd=1"></xsd:import>
		</xsd:schema>
	</types>
	<message name="welcome">
		<part name="parameters" element="tns:welcome"></part>
	</message>
	<message name="welcomeResponse">
		<part name="parameters" element="tns:welcomeResponse"></part>
	</message>
	<portType name="S01_WelcomeService">
		<operation name="welcome">
			<input message="tns:welcome"></input>
			<output message="tns:welcomeResponse"></output>
		</operation>
	</portType>
	<binding name="S01_WelcomeServicePortBinding" type="tns:S01_WelcomeService">
		<soap:binding transport="http://schemas.xmlsoap.org/soap/http" style="document"></soap:binding>
		<operation name="welcome">
		<soap:operation soapAction=""></soap:operation>
		<input>
			<soap:body use="literal"></soap:body>
		</input>
		<output>
			<soap:body use="literal"></soap:body>
		</output>
		</operation>
	</binding>
	<service name="S01_WelcomeServiceService">
		<port name="S01_WelcomeServicePort" binding="tns:S01_WelcomeServicePortBinding">
			<soap:address location="http://localhost:7075/WelcomeServices"></soap:address>
		</port>
	</service>
	</definitions>



6. Axis Client & Server
- Client:
	<!--
		1. Create Service 
		2. Create Callable object form Service
		3. Set Callable object Target
		4. Set Callable object Operation
	-->
	Service servie = new Service()
	Call call = service.createCall();
	call.setTargetEndpointAddress(URL)
	call.serOperationName (Operation)
	call.setParameter (ParameterNaine, xmlType, ParameterMode. In/Out)
	call.setReturnType (xmlType)
	Object return = call.invoke(new Object[]{})
— Server
	Setup
		1. Import Axis libraries
		2. Configure web.xml
			<!-- Configure Axis Engine -->
			<servlet>
				<display-name>Apache-Axis Servlet</display-name>
				<servlet-name>AxisServlet</servlet-name>
				<servlet-class>
					org.apache.axis.transport.http.AxisServlet
				</servlet-class>
			</servlet>
			<!-- Configure Axis Service url mapping -->
			<servlet-mapping>
				<servlet-name>AxisServlet</servlet-name>
				<url-pattern>/servlet/AxisServlet</url-pattern>
			</servlet-mapping>
			<servlet-mapping>
				<servlet-name>AxisServlet</servlet-name>
				<url-pattern>*.jws</url-pattern>
			  </servlet-mapping>
			<servlet-mapping>
				<servlet-name>AxisServlet</servlet-name>
				<url-pattern>/services/*</url-pattern>
			 </servlet-mapping>
	Service		 
		Realtime deployement: url/service.jws?wsdl
			Step1: Java class without package
			Step2: Copy java source to WebRoot
			Step3: Rename *.java to *.jws custom deployment
			Step4: Create deploy.wsdd(Web Service deployment descriptor)
		Custom deployment:
			Step1: Create Java class
			Step2: Create delpy wsdd(Web Service Deploy Descriptor)
			Step3: Run adminClient to lunch the service to generate/upload server-config.wsdd
				   -l: servietEngine address deploy.wsdd, eg AdminClient -l
				   eg. http: //localhost: 8080/webapp/service/AxisServlet deploy.wsdd
			Step4: modify scope property
				<parameter name="scope" value="session"/>
				<!-- maintain same session in different invoke -->
				call.setMaintainSession (true) 

				

7. Handler
- Process: Request -> Handler -> Webservice
— Context: Wrapper of current environment
- Setup
	Step1. Configure Handler
	<handler name="track" type="java:com.dbs.ws.server.LogHandler">
		<parameter name="filename" value="D:/Programs/Server/Apache-tomcat-6.0.36/logs/HandlerService.log" />
	</handler>
	Step2. Configure Handler in request process
	<service name="HandlerService" provider="java:RPC">
		<requestFlow>
			<handler type="track"/>
		</requestFlow>
		<parameter name="className" value="com.dbs.ws.server.HandlerServices" />
		<parameter name="allowedMethod" value="*" />
	</service>

	

8. Object in Web Service Service
- Object implements Serializable
- Server Register Object by beanMapping
	<!-- Customer Service -->
	<service name="CustomerServices" provider="java:RPC">
		<parameter name="className" value="com.dbs.ws.server.CustomerServices" />
		<parameter name="allowedMethod" value="*" />
		<beanMapping qname="ns:Customer" xmlns:ns="urn:pojo:dbs.com" languageSpecificType="com.dbs.ws.module.Customer" />
	</service>
- Client Register by TypeMapping
	<!--
		Para1: namespace in server
		Para2: class/interface nname
	-->
	QName qname new QName("urn:bean:uob:com","Customer")
	<!-- register Type mapping into Ser/Deser Factory-->
	call. registerTypeMapping (Customer, class, qname, new BeanSerializerFactory(Customer.class, qname), new BeanDeserializerFactory (Customer. class, qname))
— Note: Array/List return as Array
		Map return as Map



9. SOAP Fault
— RemoteException: RemoteException map to SOAP Fault
- Register Exception: <beanMapping qname="ns:Customer" xmlns:ns="urn:pojo:dbs.com" languageSpecificType="java:com.dbs.ws.exception.NoSuchEmployeeException" />



10. Axis WSDL2Java & Java2WSDL
- WSDL vs Java
	WSDL			Java
	Service			Interface
	portType		Class
	operation		method
- WSDL2Java: wsdl2java <wsdl> to generate client stub and server skeletion
	Options
		Common:
			-v <verbose>
			—p <package>
			—o <source>
		Server:
			--server—side
			--skeletonDeploy true
		eg. -v -p com.dbs.ws.client.customerservices -o src http://localhost:8080/Axis_03_Server/services/CustomerServices?wsdl
	Source
		Service services = new ServiceLocator();
		PortType portType = services.getServices();
- Java2WSDL: java2wsdl <java>
	Options:
			-o <wsdl>
			-l <location>
			-n <namespace>
		eg. -o wp.wsdl -l http://localhost:8080/Axis_03_Server/services/WidgetPrice com.dbs.ws.service.WidgetPrice
			
	

11. Standard Process of Developing WebServices
Stepi. Create Java Inteferace
Step2. Generate WSDL from Java using java2wsdl
Step3. Generate Java from WSDL for client and server using wsdl2java
Step4. Deploy wsdl to Server using AdminClient
		


12. WebService Upload
- Libraries
	activation.jar
	mail.jar
- Steps
	<!-- Step1. Get MessageContext 
				Get AxisServlet
				Get ServletContext 
	-->
		MessageContext mc = MessageContext.getCurrentContext();
		AxisServlet axis = (AxisServlet) mc.getProperty(HTTPConstants.MC_HTTP_SERVLET);
		ServletContext sc = axis.getServletContext();
	<!-- Step2. Greate Directory -->
		String uploadDir = sc.getRealPath("/upload");
		File dir = new File(uploadDir);
		System.out.println(dir.getAbsolutePath());
		if(!dir.exists())
			dir.mkdir();
	<!-- Step3. Read from InputStream(DataHandler) -->
		File file = new File(dir, l + ".ini");
		int sendType = msg.getAttachmentsImpl().getSendType();
		if(sendType == AttachmentsImpl.SEND_TYPE_MIME){
			InputStream is = dataHandler.getInputStream();
			byte[] bytes = new byte[is.available()];
			is.read(bytes);
			is.close();
	}
	<!-- Step4. Write from InputStream(DataHandler) -->
	OutputStream os = new FileOutputStream(file);
	os.write(bytes);
	os.close();


	
13. XFire 
- Setup
	1. Import Xfire-all.jar & Dependency libraries
 	2. Configure web deployment descriptor web.xml
		<servlet>
			<display-name>XFire Servlet</display-name>
			<servlet-name>XFireServlet</servlet-name>
		<servlet-class>org.codehaus.xfire.transport.http.XFireConfigurableServlet</servlet-class>
		</servlet>
			<servlet-mapping>
			<servlet-name>XFireServlet</servlet-name>
			<url-pattern>/servlet/XFireServlet/*</url-pattern>
		</servlet-mapping>
		<servlet-mapping>
			<servlet-name>XFireServlet</servlet-name>
			<url-pattern>/services/*</url-pattern>
		</servlet-mapping>
	3. Create services.xml under src/META—INF/xfire
		<beans xmlns="http://xfire.codehaus.org/config/1.0">
			<service>
				<name>WelcomeService</name>
				<namespace>http://xfire.codehaus.org/WelcomeService</namespace>
				<serviceClass>com.dbs.ws.services.WelcomeService</serviceClass>
				<implementationClass>com.dbs.ws.services.impl.WelcomeServiceImpl</implementationClass>
			</service>
		</beans>
	4. WSDL:	http://<host>:<port>/<proj>/services/<services>?wsdl
- Client Source Code
	Method 1: Xfire Client
		String url = "<wsdl_location>?wsdl";
		Client clt = new Client(new URL(url));
		Object[] obj = clt.invoke(<method>, new Object[] { params });
	Method 2: Xfire ProxyFactory 
		<!-- Create Service Factory -->
		String url = "http://localhost:8080/XFire_Server/services/WelcomeService";
		ObjectServiceFactory serviceFactory = new ObjectServiceFactory();
		<!-- Create Service -->
		Service serviceModel = serviceFactory.create(WelcomeService.class);
		<!-- Create ProxyFactory -->
		XFireProxyFactory proxyFactory = new XFireProxyFactory();
		<!-- Create Proxy through Service by Proxy Factory -->
		WelcomeService welcomeService = (WelcomeService) proxyFactory.create(serviceModel, url);
	Method 3: Xfire PortType(Generate by WsGen)
		<!-- Create Client -->
		WelcomeServiceClient clt = new WelcomeServiceClient();
		<!-- Create PortType -->
		WelcomeServicePortType portType = clt.getWelcomeServiceHttpPort();
- WsGen
	Generate the java source code from wsdl
	Option
	-wsdl 	<service>?<wsdl>
	-o 		<src>
	-p		<package>




14. XFire Publish Services
- XFire Http Server
	Feature: Publish Service by XFire Http Server
	Step:
		<!-- Create Object Factory-->
		ObjectServiceFactory objectServiceFactory = new ObjectServiceFactory();
		<!-- Create Services -->
		Service service = objectServiceFactory.create(WelcomeService.class);
		<!-- Invoke Services Implementation-->
		service.setInvoker(new BeanInvoker(new WelcomeServiceImpl()));
		<!-- Register Services -->
		XFire xfire = XFireFactory.newInstance().getXFire();
		xfire.getServiceRegistry().register(service);
		<!-- Start XFire Http Server-->
		XFireHttpServer server = new XFireHttpServer();
		server.setPort(8191);
		server.start();
- JSR181 Annotation
	Java
		@WebService:							Class is declared as service
		@WebMethod: 							Operation can be execute
		@WebResult(name=..)						Return result name of operation
		@WebParaxn(name=.., header=true|false)	Parameter name, if head=true, parameter is passed in header
	Services.xml
	<!-- AnnotationServiceFactory -->
	<bean name="jsr181ServiceFactory"
		class="org.codehaus.xfire.annotations.AnnotationServiceFactory">
		<constructor-arg ref="xfire.transportManager" index="0" />
		<constructor-arg ref="config" index="1"
			type="org.codehaus.xfire.aegis.type.Configuration" />
	</bean>
	<!-- Type Configuration -->
	<bean id="config" class="org.codehaus.xfire.aegis.type.Configuration">
		<property name="defaultExtensibleElements" value="false" />
		<property name="defaultExtensibleAttributes" value="false" />
		<property name="defaultNillable" value="false" />
		<property name="defaultMinOccurs" value="1" />
	</bean>
	<!-- Services with AnnotationServiceFactory -->
	<service>
		<serviceClass>org.codehaus.xfire.demo.CustomerService</serviceClass>
		<serviceFactory>#jsr181ServiceFactory</serviceFactory>
	</service>
	
	

15. XFire Binding
- Binding
	Binding has Provider and Registry
	Default Binding: AegisBindingProvider with TypeRegister/TypeCreator
		Non-Annotation: AegisBindingProvider()
		Annotation: 	AegisBindingProvider (JaxbTypeRegistry)
		Only support source to WSDL
- Java Bean Mapping
	XML: 
	<!-- XML must be same location as Java source file -->
	<!-- xmlns:np np is same as "np:..."-->
	<mappings xmlns:np="urn:north-pole:operations">
		<mapping name="np:Employee">
		   <property name="name" mappedName="Name"/>
		   <property name="title" mappedName="Title"/>
		</mapping>
	</mappings>
	<!-- No serializable -->
	<property name="pass" ignore="true"/>	
	Annotation
	@XmlType(name="PERSON", namespace="urn:pojo:person")
	public class Person {
		<!-- Property as Element -->
		@XmlElement(name="NAME", namespace="urn:name:pojo:person")
		public String getName() {...}
		<!-- Property as Attribute -->
		@XmlAttribute(name="AGE", namespace="urn:age:pojo:person")
		public int getAge() {...}
		<!-- ignore property -->
		@IgnoreProperty
		public String getPassword() {...}
	}
- Note: AegisBindingProvder only support Button up(Java2WSDL) If collection is not Generic, mapping is need



16. Apache CXF
- Overview
	Merge from XFire and Celtix
	Open-Source Service Framework
- Structure
	bin:		tool for windows/unix
	lib:		libraries with dependencies
	docs:		documents
	modules:	CXF modules libraries
- Server Side
	Built-in Jetty server
	<!--Create Server Factory-->
	JaxWsServerFactoryBean factory = new JaxWsServerFactoryBean();
	<!--Set Service class and URL-->
	factory.setServiceClass(<services>.class);
	factory.setAddress("<URL>"); 
	<!-- Create Server from factory and startup -->
	Server server = factory.create();
	server.start();
	@WebService: identify the class/interface as web service
- Client Side
	<!-- Create Proxy Factory-->
	JaxWsProxyFactoryBean factory = new JaxWsProxyFactoryBean();
	<!-- Ser Service class and URL-->
	factory.setAddress("http://localhost:8080/myservice");
	factory.setServiceClass(HelloService.class);
	<!-- Create Proxy -->
	HelloService helloService = (HelloService) factory.create();

	
	
17. TCP Mon
Without TCP Mon
	Server listen 8080
	Client send request and get response 8080
With TCP Mon
	Server listen 8080
	TCP Mon open 5555, send request and get response from target Server address and port
	Client send request get response TCP Mon port 5555
	
	

18. SOAP & WSDL
- SOAP is generated based on WSDL
	Sending Message
		<!-- soap is namespace: declared by CXF -->
		<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
		<soap:Body>
			<!-- ns2 is namespace: reverse of package -->
			<!-- sayHello is Message type of Request-->
			<ns2:sayHello xmlns:ns2="http://services.dbs.com/">
				<!-- arg is arguments -->
				<arg0>Yufeng</arg0>
				<arg1>NUS</arg1>
				<arg2>Uni</arg2>
			</ns2:sayHello>
		</soap:Body></soap:Envelope>
	Response Message
		<!-- soap is namespace: declared by CXF -->
		<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
			<soap:Body>
				<!-- sayHelloResponse is Message type of Response -->
				<ns2:sayHelloResponse xmlns:ns2="http://services.dbs.com/">
					<return>hello: Yufeng, your info is: NUS, Uni</return>
				</ns2:sayHelloResponse>
			</soap:Body>
		</soap:Envelope>
- WSDL
	<!-- Root node definitions -->
		<!-- wsdl:type		=>	Define element type -->
		<!-- wsdl:message	=>	Define message -->
		<!-- wsdl:portType	=>	Define interface [operation[input/output]] -->
		<!-- wsdl:binding	=>	Define implementation [operation[input/output]] -->
		<!-- wsdl:service	=>	Define service -->
	<wsdl:definitions xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" 
		xmlns:tns="http://impl.services.dbs.com/" 
		xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" 
		xmlns:ns2="http://schemas.xmlsoap.org/soap/http" 
		xmlns:ns1="http://services.dbs.com/" name="HelloServiceImplService" 
		targetNamespace="http://impl.services.dbs.com/">	
		<!-- Define the element -->
		<wsdl:types>
			<xs:schema>
				<xs:element name="sayHello" type="tns:sayHello"/>
				<xs:element name="sayHelloResponse" type="tns:sayHelloResponse"/>
				<!-- Define the type of element for reqeust message-->
				<xs:complexType name="sayHello">
				</xs:complexType>
				<!-- Define the type of element for response message-->
				<xs:complexType name="sayHelloResponse">
				</xs:complexType>
			</xs:schema>
		</wsdl:types>
		<!-- Define message -->
		<wsdl:message name="queryByProductNameRequest">
			<wsdl:part name="parameters" element="tns:queryByProductNameRequest" ></wsdl:part>
		</wsdl:message>
		<wsdl:message name="queryByProductNameResponse">
			<wsdl:part name="parameters" element="tns:queryByProductNameResponse" ></wsdl:part>
		</wsdl:message>
		<!-- Define interface -->
		<wsdl:portType name="MyService">
			<!-- Define Operation including input & output -->
			<wsdl:operation name="queryByProductName">
				<wsdl:input message="tns:queryByProductNameRequest" name="queryByProductNameRequest"></wsdl:input>
				<wsdl:output message="tns:queryByProductNameResponse" name="queryByProductNameResponse"></wsdl:output>
			</wsdl:operation>
		</wsdl:portType>
		<wsdl:import location="http://localhost:8080/myservice?wsdl=HelloService.wsdl" namespace="http://services.dbs.com/"></wsdl:import>
		<!-- Define implementation -->
		<wsdl:binding name="HelloServiceImplServiceSoapBinding" type="ns1:HelloService">...</wsdl:binding>
			<soap:operation soapAction="" style="document"/>
			<!-- Define Operation including input & output -->
			<wsdl:operation name="queryByProductName">
				<soap:operation soapAction="" style="document"/>
				<wsdl:input name="queryByProductNameRequest">
					<soap:body use="literal"/>
				</wsdl:input>
				<wsdl:output name="queryByProductNameResponse">
					<soap:body use="literal"/>
				</wsdl:output>
			</wsdl:operation>
		</wsdl:binding>
		<!-- Define services -->
		<wsdl:service name="HelloServiceImplService"></wsdl:service>
	</wsdl:definitions>
- Class in WSDL
	Collection
		<!-- Define collection by minOccurs and maxOccurs-->
		<xsd:complexType name="ListOfStudent">
			<xsd:sequence>
				<xsd:element name="students" type="tns:Student" minOccurs="0" maxOccurs="unbounded"/>
			</xsd:sequence>
		</xsd:complexType>
	Enum
		<!-- Define enumeration by restriction -->
		<xsd:simpleType name="Role">
			<xsd:restriction base="xs:string">
				<xsd:enumeration value="STUDENT"/>
				<xsd:enumeration value="TEACHER"/>
				<xsd:enumeration value="PRESIDENT"/>
			</xsd:restriction>
		</xsd:simpleType>		
	Void
		<!-- Define void without elements -->
		<xsd:complexType>
			<xsd:sequence/>
		</xsd:complexType>	
	Bytes
		<!-- Define bytes -->
		<xsd:element name="..." type="xsd:base64Binary" />
		
		
	
19. Java API For XML Binding(JAXB)
- JAXBContext:	entry point for JAXB API
- Marshalling:	Java content tree to XML data
	JAXBContext jaxbContext = JAXBContext.newInstance(Student.class);
	Marshaller marshaller = jaxbContext.createMarshaller();
	marshaller.marshal(student, new File("Student.xml"));
- Unmarshalling:	XML data to Java content tree
	JAXBContext jaxbContext = JAXBContext.newInstance(Student.class);
	Unmarshaller unmarshaller = jaxbContext.createUnmarshaller();
	Student student = (Student)unmarshaller.unmarshal(new File("Student.xml"));

	

20. WebService Development mode
- Development Mode
	Top-down:	WSDL -> Java src
	Bottom-up:	Java src -> WSDL
	Mix:		Jave src -> WSDL -> Java src
- Wsdl2java 
	-p:			package
	—d:			directory for source code
	-frontend:	supports JAXWS frontend  
	—client:	generate starting code for client
	—server:	generate starting code for server
	—impi:		generate starting code for implementation object run wsdl2java generate java source code from wsdl generate request class and response class

	

21. MTOM
- SOAP Message Transmission Optimization Machinism
— MTOM implementation
	WSDL: 
		<!-- Enable namespace xmime -->
		<xs:schema elementFormDefault="unqualified" targetNamespace="http://cxf.order.com/"
		version="1.0" xmlns:tns="http://cxf.order.com/" xmlns:xs="http://www.w3.org/2001/XMLSchema"
		xmlns:xmime="http://www.w3.org/2005/05/xmlmime">
		<!-- Binary as stream -->
		<xsd:complexType name="UploadFile">
			<xsd:sequence>
				<xsd:element name="fileContent" type="xsd:base64Binary"
					xmime:expectedContentTypes="application/octet-stream"></xsd:element>
			</xsd:sequence>
		</xsd:complexType>
	Annotation: @XmlMimeType(’Tapplication/octet_streamT) DataHandler attachment
	Server: 
		SOAPBinding binding = (SOAPBinding)endPoint.getBinding();
		binding.setMTOMEnabled(true);
	Client: 
		Binding binding = ((BindingProvider) myServicePortType) . getBinding (); 
		((SOAPBinding) binding) . setNTOMEnabled (true);
	Upload Process:
		Client:
			DataSource dataSource = new FileDataSource(new File("..."));
			DataHandler dataHandler = new DataHandler(dataSource);
		Server:
			DataHandler dataHandler = parameters.getFileContent();
			InputStream is = dataHandler.getInputStream();
			
		
		
22. Web Service Tools
- JMeter
	Test tools for Performance testing
	Thread Group TestCase
		1. Create Thread Group
		2. Add Sampler, eg. Http, SOAP, JMS
		3. Add Listener, eg, Result Tree, Result Table, Summary Report
	Remote Test (RMI)
		1. Start Jmeter-Sever in Agent
		2. Start Remote Test from Controller
- SoapUI
	Visulization tools for WebService Unit and Load Test
	Test Case
		1. Input WSDL location
		2. Add Test Request
		3. Generate Test Case Suit, eg Unit test, Load Test
		4. Run Unit test with assertion
		5. Run Load test
		
	

22. Apache CXF Spring
- Add CXF Spring libraries
- Web.xml
	<!-- Configure central controller -->
	<servlet>
		<servlet-name>cxf</servlet-name>
		<servlet-class>org.apache.cxf.transport.servlet.CXFServlet</servlet-class>
	</servlet>
	<servlet-mapping>
		<servlet-name>cxf</servlet-name>
		<url-pattern>/servlet/*</url-pattern>
	</servlet-mapping>
	<!-- Listener -->
	<listener>
		<listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
	</listener>
- ApplicationContext.xml
	<!-- Add jaxws namespace -->
	<!-- Add schemaLocation -->
	<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
	xmlns:jaxws="http://cxf.apache.org/jaxws"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
	http://cxf.apache.org/jaxws http://cxf.apache.org/schemas/jaxws.xsd">
	<!-- Import resource cxf.xml & cxf-servlet.xml -->
	<import resource="classpath:META-INF/cxf/cxf.xml" />
	<import resource="classpath:META-INF/cxf/cxf-servlet.xml" />
	<!-- Define service address and implementation -->
	<jaxws:endpoint id="helloworld" implementor="com.cxf.service.impl.HelloServiceImpl" address="/HelloService" />
- URL 
	http://localhost:8080/<project>/servlet/<service>?wsdl
	

23. Restful Web Services
- Overview
	Representational Status Transfer by Roy Thomas
	HTTP: Hyper text transfer protocal is application protocal but not only transfer protocal
	Resource—Orented Architecture
- Theory:
	Get: request resource
	Post: append new data after request URI
	Delete: request delete the URI resource
	Put: request to store the resource
- HttStatus
	200 OK
	400 Bad Request
	401 Unauthorized
	403 Forbidden
	404 Not Found
	500 Internal Server Error
	503 Service Unavailable
- Java Implementation
	JAX-RS: Java API for Restful Web Service
	Restful Web Service Framework: CXF, Axis2, Restlet

	
	
22. CXF Restful Implementation
- Model
	@XmlRootElement
	public class Person { ... }
- Service
	<!-- Declare the URL path -->
	<!-- Declare data format, eg xml, json -->
	@Path(value = "/person")
	@Produces("application/xml")
	public interface PersonService {
		<!-- Declare method of request -->
		<!-- Declare the sub URL path and Path Parameter -->
		@GET
		@Path(value = "/profile/{id}")
		public Person getPersonById(@PathParam(value = "id") int id);
		<!-- Declare the sub URL path and Query Parameter -->
		<!-- URL: /list/byAget?minAge=<v1>&&maxAge=<v2> -->
		@GET
		@Path(value = "/list/byAge")
		public List<Person> getPersonListByAge(@QueryParam("minAge") int minAge, @QueryParam("maxAge") int maxAge);
	}
- Server
	JAXRSServerFactoryBean factory = new JAXRSServerFactoryBean();
	factory.setAddress(<URL>);
	factory.setResourceClasses(<Class>);
	factory.create();
- Client
	WebClient webClient = WebClient.create(<MainURL>);
	webClient.path(<URL>).accept(<datatype>).type(<datatype>).get(<Class>);
	webClient.path(<URL>).accept(<datatype>).type(<datatype>).getCollection(<Class>);	
		